<section class="hgroup">
	<h2>Calendario AgendaPro</h2>
<div class="line-breadcrumb">
    <ul class="breadcrumb pull-right">
        <li><%= link_to "Resumen", dashboard_path %> </li>
        <li class="active">Calendario AgendaPro</li>
    </ul>
</div>
</section>

<div class="col-md-12">
	<div class="row">
		<div  id="locals-selector" class="radio">
			<% @locations.each do |local| %>
				<label id="<%= local.id %>" >
					<input type="radio" name="localRadio" id="localOption<%= local.id %>" onchange="loadProviders()" value="<%= local.id %>" <%= 'checked' if ((!@selectedLocal) && (local.id == @locations.first.id)) || (@selectedLocal.to_i == local.id) %>>
					<p><%= local.name %></p>
				</label>
			<% end %>
		</div>
	</div>

	<div class="row">
		<div id="providers-selector" class="radio">
			<%= image_tag "ajax-loader.gif", :alt => "Loader" %>
		</div>
	</div>
	<div class="row">
		<input type="hidden" id="dp" class="pull-right"/>
		<div>
			<%= link_to '<i class="fa fa-times"></i>  Bloquear Horas / Vacaciones'.html_safe, '#', :class => "btn btn-primary btn-md createBreak pull-right modal-trigger" unless current_user.role_id == Role.find_by_name('Staff').id %>
		</div>
		<div id="add_booking">
			<%= link_to '<i class="fa fa-calendar"></i>  Agregar Reserva'.html_safe, '#', :class => "btn btn-primary btn-md createBooking pull-right modal-trigger" %>
		</div>
	</div>
	<div class="row">
		<div id='calendar'></div>
	</div>
</div>
<div class="modal fade" id="bookingModal" tabindex="-1" role="dialog" aria-labelledby="bookingModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title booking-modal-title" id="bookingModalLabel"></h4>
			</div>
			<div class="modal-body booking-modal-body">
				<%= form_for @booking, html: {class: "form-horizontal"} do |f| %>
				<div class="form-group">
					<label class="col-sm-5 control-label">Fecha: </label>
					<div class="col-sm-5">
						<input type="text" id="datePicker" class="form-control">
					</div>
				</div>
				<div class="form-group">
					<label class="col-sm-5 control-label">Horario de la Reserva: </label>
					<div class="col-sm-5">
						<div class="input datetime required booking_start">       
							<select class="datetime required" id="bookingStartHour" name="booking[start_hours]">
								<option value="00">00</option>
								<option value="01">01</option>
								<option value="02">02</option>
								<option value="03">03</option>
								<option value="04">04</option>
								<option value="05">05</option>
								<option value="06">06</option>
								<option value="07">07</option>
								<option value="08">08</option>
								<option value="09">09</option>
								<option value="10">10</option>
								<option value="11">11</option>
								<option value="12">12</option>
								<option value="13">13</option>
								<option value="14">14</option>
								<option value="15">15</option>
								<option value="16">16</option>
								<option value="17">17</option>
								<option value="18">18</option>
								<option value="19">19</option>
								<option value="20">20</option>
								<option value="21">21</option>
								<option value="22">22</option>
								<option value="23">23</option>
							</select>
							 : <select class="datetime required" id="bookingStartMinute" name="booking[start_minutes]">
								<option value="00">00</option>
								<option value="05">05</option>
								<option value="10">10</option>
								<option value="15">15</option>
								<option value="20">20</option>
								<option value="25">25</option>
								<option value="30">30</option>
								<option value="35">35</option>
								<option value="40">40</option>
								<option value="45">45</option>
								<option value="50">50</option>
								<option value="55">55</option>
							</select> - <span id="bookingEnd">00:00</span>
						</div>
					</div>
				</div>
				<div class="form-group">
					<%= f.label :service_provider_id, "Proveedor de Servicios: ", class: "col-sm-5 control-label" %>
					<div class="col-sm-5">
						<%= f.collection_select :service_provider_id, ServiceProvider.where(location_id: Location.where(company_id: current_user.company_id, :active => true).accessible_by(current_ability)), :id, :public_name, {}, { class: "form-control" }%>
					</div>
				</div>
				<div class="form-group">
					<%= f.label :service, "Servicio: ", class: "col-sm-5 control-label" %>
					<div class="col-sm-5">
						<select class="form-control" id="booking_service_id" name="booking[service_id]" disabled></select>
						<!-- <%= f.collection_select :service_id, Service.where(company_id: current_user.company_id), :id, :name, {}, { class: "form-control" }%> -->
					</div>
				</div>
				<div class="form-group">
					<%= f.label :status, "Estado de la Reserva: ", class: "col-sm-5 control-label" %>
					<div class="col-sm-5">
						<%= f.collection_select :status_id, Status.all, :id, :name, {selected: Status.find_by(:name => 'Reservado').id}, { class: "form-control" }%>
					</div>
				</div>
				<div class="form-group">
					<%= f.label :email, "Email: ", class: "col-sm-5 control-label" %>
					<div class="col-sm-5">
						<%= f.text_field :email, class: "form-control" %>
						<ul id="suggestions"></ul>
					</div>
				</div>
				<div class="form-group">
					<%= f.label :first_name, "Nombre: ", class: "col-sm-5 control-label" %>
					<div class="col-sm-5">
						<%= f.text_field :first_name, class: "form-control" %>
					</div>
				</div>
				<div class="form-group">
					<%= f.label :last_name, "Apellidos: ", class: "col-sm-5 control-label" %>
					<div class="col-sm-5">
						<%= f.text_field :last_name, class: "form-control" %>
					</div>
				</div>
				<div class="form-group">
					<%= f.label :phone, "TelÃ©fono: ", class: "col-sm-5 control-label" %>
					<div class="col-sm-5">
						<%= f.text_field :phone, class: "form-control" %>
					</div>
				</div>
				<div class="form-group">
					<%= f.label :notes, "Notas: ", class: "col-sm-5 control-label" %>
					<div class="col-sm-5">
						<%= f.text_area :notes, class: "form-control" %>
					</div>
				</div>
				<% end %>
			</div>
			<div class="modal-footer booking-modal-footer">
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="breakModal" tabindex="-1" role="dialog" aria-labelledby="breakModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title break-modal-title" id="breakModalLabel">Bloquear Horas o Agregar Vacaciones</h4>
			</div>
			<div class="modal-body break-modal-body">
				<%= form_for @provider_break, html: {class: "form-horizontal"} do |f| %>
					<div class="form-group">
						<%= f.label :service_provider_id, "Proveedor de Servicios: ", class: "col-sm-3 control-label" %>
						<div class="col-sm-9">
							<%= f.collection_select :service_provider_id, ServiceProvider.where(location_id: Location.where(company_id: current_user.company_id, :active => true).accessible_by(current_ability)), :id, :public_name, {}, { class: "form-control" }%>
						</div>
					</div>
					<div class="form-group">
						<%= f.label :start, "Inicio: ", class: "col-sm-3 control-label" %>
						<div class="col-sm-9">
							<%= f.datetime_select :start, {}, {class: "form-control date-select"} %>
						</div>
					</div>
					<div class="form-group">
						<%= f.label :end, "Fin: ", class: "col-sm-3 control-label" %>
						<div class="col-sm-9">
							<%= f.datetime_select :end, {}, {class: "form-control date-select"} %>
						</div>
					</div>
				<% end %>
			</div>
			<div class="modal-footer break-modal-footer">
			</div>
		</div>
	</div>
</div>

<% content_for :scripts do %>
	<%= javascript_include_tag "bookings" %>
	<%= stylesheet_link_tag "jquery-ui-1.10.4" %>
	<%= javascript_include_tag "jquery-ui-1.10.4.min.js" %>
<% end %>
