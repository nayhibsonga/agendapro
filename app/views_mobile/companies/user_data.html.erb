<div class="container container-margin">
	<div class="row">
		<div class="col-xs-12">
			<%= form_tag("book", method: "post", role: "form", id: "bookingForm") do %>
            	<%= hidden_field_tag :service, @service.id %>
            	<%= hidden_field_tag :provider, @provider.id %>
            	<%= hidden_field_tag :start, @start %>
            	<%= hidden_field_tag :end, @end %>
            	<%= hidden_field_tag :origin, @origin %>
            	<%= hidden_field_tag :location, @location.id %>
            	<%= hidden_field_tag :provider_lock, @lock %>
            	<%= hidden_field_tag :firstName, if user_signed_in? then current_user.first_name else nil end %>
                <%= hidden_field_tag :lastName, if user_signed_in? then current_user.last_name else nil end %>
            	<div id="user-data">
					<div class="form-group">
						<input type="text" id="full_name" name="user[full_name]" class="form-control" placeholder="Nombre completo" required <%= 'disabled' if @location.company.company_setting.client_exclusive %>>
                        <span class="help-block"></span>
					</div>
					<div class="form-group">
						<%= email_field_tag(:email, if user_signed_in? then current_user.email else nil end, :class => "form-control", :placeholder => "E-mail", :required => true) %>
						<span class="help-block"></span>
					</div>
					<div class="form-group">
						<%= telephone_field_tag(:phone, if user_signed_in? then current_user.phone else nil end, :class => "form-control", :placeholder => "Teléfono", :required => true) %>
						<span class="help-block"></span>
					</div>
            	</div>
            	<% if user_signed_in? %>
            	<div class="form-group">
            		<p id="user-message">Estas agendando como <strong><%= current_user.email %></strong>.<br /> Si no eres tu, haz click <a href="#" id="user-change">aquí</a><br /></p>
            	</div>
            	<% end %>
            	<% if @location.company.company_setting.client_exclusive %>
				<div class="form-group">
					<%= text_field_tag(:identification_number, nil, :class => "form-control", :placeholder => "RUT" ) %>
					<span class="help-block"></span>
				</div>
				<% end %>
				<% if @service.outcall %>
				<div id="outcallAddress" class="form-group">
					<%= text_field_tag(:address, nil, :class => "form-control", :placeholder => "Escribe la dirección donde se debe realizar el servicio" ) %>
					<span class="help-block"></span>
				</div>
				<% end %>
				<div class="form-group">
					<%= text_area_tag(:comment, nil, :class => "form-control", :placeholder => "Agrega algún comentario a tu reserva en caso de ser necesario..", :rows => 4) %>
				</div>
				<div class="form-group">
					<button type="submit" class="btn btn-green btn-block" id="submitBtn">Reservar</button>
				</div>
			<% end %>
		</div>
	</div>
</div>

<%= content_tag "div", id: "selectedLocal", data: {local: @location, district: @location.district.name} do %>
<% end %>

<% content_for :scripts do %>
<%= javascript_include_tag 'split-name' %>
<%= javascript_include_tag 'validations/validate' %>
<%= javascript_include_tag 'validations/home/workflow' %>
<script type="text/javascript">
	$(function() {
		compose_name('#full_name', '#firstName', '#lastName');
		split_name('#full_name', '#firstName', '#lastName');
		<% if user_signed_in? %>
		$('#user-data').hide();
		$('#user-change').click(function () {
			$('#user-data').show();
			$('#user-message').hide();
		});
		<% end %>
		$('.volver').click(function () {
			history.back();
			return false;
		});
	});
</script>
<% end %>